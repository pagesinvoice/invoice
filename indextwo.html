<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Thermal POS Receipt</title>
    <style>
      #thermal-pos {
        box-shadow: 0 0 0mm #eee;
        margin: 0mm;
        max-width: 80mm;
        line-height: 4mm;
      }

      #thermal-pos h2 {
        font-size: 4mm;
        line-height: 13px;
      }

      #thermal-pos .label {
        text-align: center;
        font-size: 5mm;
        line-height: 1.3;
      }
      #thermal-pos .informasi {
        vertical-align: text-top;
        text-align: left;
        max-width: 45mm;
        word-wrap: break-word;
      }

      #thermal-pos .listitem {
        font-size: 4mm;
        height: 0mm;
        text-align: center;
      }
      #thermal-pos table {
        width: 100%;
      }

      #thermal-pos .item {
        max-width: 80mm;
        font-size: 4.2mm;
        word-wrap: break-word;
        width: 100%;
      }
      #thermal-pos .amount {
        vertical-align: center;
        text-align: right;
        font-size: 4.2mm;
      }

      #thermal-pos .price {
        vertical-align: center;
        text-align: center;
        font-size: 4.2mm;
      }

      #thermal-pos .desc {
        vertical-align: center;
        text-align: center;
        font-size: 4.2mm;
      }

      #thermal-pos .qty {
        vertical-align: center;
        text-align: center;
        font-size: 4.2mm;
      }

      #thermal-pos .Isv {
        vertical-align: center;
        text-align: right;
        font-size: 4.2mm;
      }
      #thermal-pos .bawah {
        margin-top: 5mm;
        text-align: center;
        height: 90px;
        page-break-after: auto;
      }
      #thermal-pos .detail1 {
        margin-top: 5mm;
        text-align: right;
        page-break-after: auto;
      }

      #thermal-pos .detail {
        margin-top: 5mm;
        text-align: left;
        page-break-after: auto;
      }

      #all {
        font-family: Arial, sans-serif;
      }

      .mi-imagen {
        width: 150px;
        height: 150px;
      }
    </style>
  </head>
  <body id="all">
    <div id="thermal-pos">
      <div class="label">
        <img src="logo.jpg" alt="Mi imagen" class="mi-imagen" /><br />
        <b id="empresa"></b><br />
        <b id="razon"></b>
        <div class="label">
          <b>RTN: <span id="rtn"></span></b>
          <br />
        </div>
        <div class="label">
          <b>Direccion: <span id="direccion"></span></b>
          <br />
        </div>
        <div class="label">
          <b>Telefono: <span id="telefono"></span></b>
          <br />
        </div>
        <div class="label">
          <b id="email"></b>
          <br />
        </div>
      </div>

      <div align="center">------------------------------------------------</div>
      <div align="center" id="tipodoc"></div>
      <div align="center">------------------------------------------------</div>

      <table>
        <tr>
          <td class="informasi">Factura:</td>
          <td class="informasi" id="factura"></td>
        </tr>
        <tr>
          <td class="informasi">Fecha:</td>
          <td class="informasi" id="date"></td>
        </tr>
        <tr>
          <td class="informasi">CAI:</td>
          <td class="informasi" id="cai"></td>
        </tr>
        <tr>
          <td class="informasi">Rango:</td>
          <td class="informasi" id="rango"></td>
        </tr>
        <tr>
          <td class="informasi">Limite:</td>
          <td class="informasi" id="limite"></td>
        </tr>
      </table>
      <div align="center">------------------------------------------------</div>
      <div align="center">Datos del cliente</div>
      <div align="center">------------------------------------------------</div>
      <table>
        <tr>
          <td class="informasi">Cliente:</td>
          <td class="informasi" id="cliente"></td>
        </tr>
        <tr>
          <td class="informasi">RTN:</td>
          <td class="informasi" id="rtncliente"></td>
        </tr>
        <tr>
          <td class="informasi">Direccion:</td>
          <td class="informasi" id="direccioncliente"></td>
        </tr>
        <tr>
          <td class="informasi">Telefono:</td>
          <td class="informasi" id="telefonocliente"></td>
        </tr>
      </table>
      <div align="center">------------------------------------------------</div>
      <div align="center">Condiciones de pago</div>
      <div align="center">------------------------------------------------</div>
      <table>
        <tr>
          <td class="informasi">Forma de pago:</td>
          <td class="informasi" id="formapago"></td>
        </tr>
        <tr>
          <td class="informasi">Plazo en d√≠as:</td>
          <td class="informasi" id="plazo"></td>
        </tr>
        <tr>
          <td class="informasi">Cantida de pagos:</td>
          <td class="informasi" id="pagos"></td>
        </tr>
        <tr>
          <td class="informasi">Cuota por pago:</td>
          <td class="informasi">L<span id="cuota"></span></td>
        </tr>
      </table>
      <div align="center">------------------------------------------------</div>
      <div align="center">Datos del cliente exonerado</div>
      <div align="center">------------------------------------------------</div>

      <table>
        <tr>
          <td class="informasi">O. C. Exenta:</td>
          <td class="informasi" id="ocexe"></td>
        </tr>
        <tr>
          <td class="informasi">O. C. Exonerada:</td>
          <td class="informasi" id="ocexo"></td>
        </tr>
        <tr>
          <td class="informasi">No. Reg. SAG:</td>
          <td class="informasi" id="nosag"></td>
        </tr>
      </table>
      <div align="center">------------------------------------------------</div>
      <div align="center">Detalle</div>
      <div align="center">------------------------------------------------</div>

      <table>
        <tr class="listitem">
          <td>
            <h2>Cant</h2>
          </td>
          <td>
            <h2>Precio</h2>
          </td>
          <td>
            <h2>Desc.</h2>
          </td>
          <td>
            <h2>Isv</h2>
          </td>
          <td>
            <h2>Monto</h2>
          </td>
        </tr>
      </table>
      <div align="center">------------------------------------------------</div>

      <table id="productTable">
        <!-- Product rows will be inserted here -->
      </table>

      <div align="center">------------------------------------------------</div>
      <table>
        <tr>
          <td class="detail">Subtotal</td>
          <td class="detail1">L<span id="subtotal"></span></td>
        </tr>
        <tr>
          <td class="detail">Descuento</td>
          <td class="detail1">L<span id="descuento"></span></td>
        </tr>
        <tr>
          <td class="detail">Subtotal exento:</td>
          <td class="detail1">L<span id="subtotalexe"></span></td>
        </tr>
        <tr>
          <td class="detail">Subtotal exonerado:</td>
          <td class="detail1">L<span id="subtotalexo"></span></td>
        </tr>
        <tr>
          <td class="detail">Subtotal 15%:</td>
          <td class="detail1">L<span id="subtotalisv15"></span></td>
        </tr>
        <tr>
          <td class="detail">Subtotal 18%:</td>
          <td class="detail1">L<span id="subtotalisv18"></span></td>
        </tr>
        <tr>
          <td class="detail">Impuesto 15%:</td>
          <td class="detail1">L<span id="isv15"></span></td>
        </tr>
        <tr>
          <td class="detail">Impuesto 18%:</td>
          <td class="detail1">L<span id="isv18"></span></td>
        </tr>
        <tr>
          <td class="detail">Total venta:</td>
          <td class="detail1">L<span id="total"></span></td>
        </tr>
        <tr>
          <td class="detail">Recibido:</td>
          <td class="detail1">L<span id="recibido"></span></td>
        </tr>
        <tr>
          <td class="detail">Cambio:</td>
          <td class="detail1">L<span id="cambio"></span></td>
        </tr>
      </table>

      <div align="center">------------------------------------------------</div>

      <div id="montoLetras"></div>

      <div align="center">------------------------------------------------</div>
      <div align="center">Gracias por su preferencia!!</div>
      <div align="center">Original: Cliente, Copia: Emisor</div>
      <div align="center">------------------------------------------------</div>

      <div style="text-align: center">
        <img alt="Barcode Generator TEC-IT" id="barcode" />
      </div>
      <div align="center">------------------------------------------------</div>
      <div
        style="
          padding-top: 8px;
          text-align: center;
          font-size: 15px;
          font-family: Source Sans Pro, Arial, sans-serif;
        "
      >
        <span>www.rmposhn.com</span><br />
        <span>indime.hn@gmail.com</span><br />
        <span>(+504) 9359-3126</span>
      </div>
    </div>

    <script>
      // Function to get URL parameters
      function getUrlParameter(name) {
        name = name.replace(/[\[]/, "\\[").replace(/[\]]/, "\\]");
        var regex = new RegExp("[\\?&]" + name + "=([^&#]*)");
        var results = regex.exec(location.search);
        return results === null
          ? ""
          : decodeURIComponent(results[1].replace(/\+/g, " "));
      }

      // Function to set text content of an element
      function setTextContent(id, value) {
        document.getElementById(id).textContent = value;
      }

      // Populate the receipt with data from URL parameters
      setTextContent("empresa", getUrlParameter("empresa"));
      setTextContent("razon", getUrlParameter("razon"));
      setTextContent("rtn", getUrlParameter("rtn"));
      setTextContent("direccion", getUrlParameter("direccion"));
      setTextContent("telefono", getUrlParameter("telefono"));
      setTextContent("email", getUrlParameter("email"));
      setTextContent("tipodoc", getUrlParameter("tipodoc"));
      setTextContent("factura", getUrlParameter("factura"));
      setTextContent("date", getUrlParameter("date"));
      setTextContent("cai", getUrlParameter("cai"));
      setTextContent("rango", getUrlParameter("rango"));
      setTextContent("limite", getUrlParameter("limite"));
      setTextContent("cliente", getUrlParameter("cliente"));
      setTextContent("rtncliente", getUrlParameter("rtncliente"));
      setTextContent("direccioncliente", getUrlParameter("direccioncliente"));
      setTextContent("telefonocliente", getUrlParameter("telefonocliente"));
      setTextContent("formapago", getUrlParameter("formapago"));
      setTextContent("plazo", getUrlParameter("plazo"));
      setTextContent("pagos", getUrlParameter("pagos"));
      setTextContent("cuota", getUrlParameter("cuota"));
      setTextContent("ocexe", getUrlParameter("ocexe"));
      setTextContent("ocexo", getUrlParameter("ocexo"));
      setTextContent("nosag", getUrlParameter("nosag"));
      setTextContent("subtotal", getUrlParameter("subtotal"));
      setTextContent("descuento", getUrlParameter("descuento"));
      setTextContent("subtotalexe", getUrlParameter("subtotalexe"));
      setTextContent("subtotalexo", getUrlParameter("subtotalexo"));
      setTextContent("subtotalisv15", getUrlParameter("subtotalisv15"));
      setTextContent("subtotalisv18", getUrlParameter("subtotalisv18"));
      setTextContent("isv15", getUrlParameter("isv15"));
      setTextContent("isv18", getUrlParameter("isv18"));
      setTextContent("total", getUrlParameter("total"));
      setTextContent("recibido", getUrlParameter("recibido"));
      setTextContent("cambio", getUrlParameter("cambio"));

      // Populate product table
      var descriptions = getUrlParameter("descriptions").split(",");
      var quantitys = getUrlParameter("quantitys").split(",");
      var prices = getUrlParameter("price").split(",");
      var descproductos = getUrlParameter("descproducto").split(",");
      var isvproductos = getUrlParameter("isvproducto").split(",");
      var amounts = getUrlParameter("amounts").split(",");

      var productTable = document.getElementById("productTable");
      for (var i = 0; i < descriptions.length; i++) {
        var row = productTable.insertRow();
        row.innerHTML = `
                <td colspan="5" class="descriptions">${descriptions[i]}</td>
                </tr>
                <tr class="listitem">
                <td class="qty">${quantitys[i]}</td>
                <td class="Price">${prices[i]}</td>
                <td class="Desc">${descproductos[i]}</td>
                <td class="Isv">${isvproductos[i]}</td>
                <td class="Amount">${amounts[i]}</td>
            `;
      }

      document.getElementById("barcode").src =
        "https://barcode.tec-it.com/barcode.ashx?data=" +
        getUrlParameter("Folio_1");

      // Function to convert number to words (Spanish)
      function numeroALetras(numero) {
        function Unidades(num) {
          switch (num) {
            case 1:
              return "UN";
            case 2:
              return "DOS";
            case 3:
              return "TRES";
            case 4:
              return "CUATRO";
            case 5:
              return "CINCO";
            case 6:
              return "SEIS";
            case 7:
              return "SIETE";
            case 8:
              return "OCHO";
            case 9:
              return "NUEVE";
          }
          return "";
        }

        function Decenas(num) {
          let decena = Math.floor(num / 10);
          let unidad = num - decena * 10;

          switch (decena) {
            case 1:
              switch (unidad) {
                case 0:
                  return "DIEZ";
                case 1:
                  return "ONCE";
                case 2:
                  return "DOCE";
                case 3:
                  return "TRECE";
                case 4:
                  return "CATORCE";
                case 5:
                  return "QUINCE";
                default:
                  return "DIECI" + Unidades(unidad);
              }
            case 2:
              switch (unidad) {
                case 0:
                  return "VEINTE";
                default:
                  return "VEINTI" + Unidades(unidad);
              }
            case 3:
              return "TREINTA" + (unidad > 0 ? " Y " + Unidades(unidad) : "");
            case 4:
              return "CUARENTA" + (unidad > 0 ? " Y " + Unidades(unidad) : "");
            case 5:
              return "CINCUENTA" + (unidad > 0 ? " Y " + Unidades(unidad) : "");
            case 6:
              return "SESENTA" + (unidad > 0 ? " Y " + Unidades(unidad) : "");
            case 7:
              return "SETENTA" + (unidad > 0 ? " Y " + Unidades(unidad) : "");
            case 8:
              return "OCHENTA" + (unidad > 0 ? " Y " + Unidades(unidad) : "");
            case 9:
              return "NOVENTA" + (unidad > 0 ? " Y " + Unidades(unidad) : "");
            case 0:
              return Unidades(unidad);
          }
        }

        function Centenas(num) {
          let centenas = Math.floor(num / 100);
          let decenas = num - centenas * 100;

          switch (centenas) {
            case 1:
              if (decenas > 0) return "CIENTO " + Decenas(decenas);
              return "CIEN";
            case 2:
              return "DOSCIENTOS " + Decenas(decenas);
            case 3:
              return "TRESCIENTOS " + Decenas(decenas);
            case 4:
              return "CUATROCIENTOS " + Decenas(decenas);
            case 5:
              return "QUINIENTOS " + Decenas(decenas);
            case 6:
              return "SEISCIENTOS " + Decenas(decenas);
            case 7:
              return "SETECIENTOS " + Decenas(decenas);
            case 8:
              return "OCHOCIENTOS " + Decenas(decenas);
            case 9:
              return "NOVECIENTOS " + Decenas(decenas);
          }

          return Decenas(decenas);
        }

        function Seccion(num, divisor, strSingular, strPlural) {
          let cientos = Math.floor(num / divisor);
          let resto = num - cientos * divisor;

          let letras = "";

          if (cientos > 0)
            if (cientos > 1) letras = Centenas(cientos) + " " + strPlural;
            else letras = strSingular;

          if (resto > 0) letras += "";

          return letras;
        }

        function Miles(num) {
          let divisor = 1000;
          let cientos = Math.floor(num / divisor);
          let resto = num - cientos * divisor;

          let strMiles = Seccion(num, divisor, "UN MIL", "MIL");
          let strCentenas = Centenas(resto);

          if (strMiles == "") return strCentenas;

          return strMiles + " " + strCentenas;
        }

        function Millones(num) {
          let divisor = 1000000;
          let cientos = Math.floor(num / divisor);
          let resto = num - cientos * divisor;

          let strMillones = Seccion(
            num,
            divisor,
            "UN MILLON DE",
            "MILLONES DE"
          );
          let strMiles = Miles(resto);

          if (strMillones == "") return strMiles;

          return strMillones + " " + strMiles;
        }

        function NumeroALetras(num) {
          let data = {
            numero: num,
            enteros: Math.floor(num),
            centavos: Math.round(num * 100) - Math.floor(num) * 100,
            letrasCentavos: "",
            letrasMonedaPlural: "LEMPIRAS",
            letrasMonedaSingular: "LEMPIRA",
          };

          if (data.centavos > 0) {
            data.letrasCentavos =
              "CON " +
              (function () {
                if (data.centavos == 1)
                  return Millones(data.centavos) + " CENTAVO";
                else return Millones(data.centavos) + " CENTAVOS";
              })();
          }

          if (data.enteros == 0)
            return (
              "CERO " + data.letrasMonedaPlural + " " + data.letrasCentavos
            );
          if (data.enteros == 1)
            return (
              Millones(data.enteros) +
              " " +
              data.letrasMonedaSingular +
              " " +
              data.letrasCentavos
            );
          else
            return (
              Millones(data.enteros) +
              " " +
              data.letrasMonedaPlural +
              " " +
              data.letrasCentavos
            );
        }

        return NumeroALetras(numero);
      }

      // Set monto en letras
      var total = parseFloat(getUrlParameter("total"));
      document.getElementById("montoLetras").textContent =
        "SON " + numeroALetras(total) + " LEMPIRAS";

      // Trigger print when the page loads
      window.onload = function () {
        window.print();
      };
    </script>
  </body>
</html>
